# Fabricio

Как говрилось docker-compose очень не удобен, тем что нельзя динамичиски конфигурировать, нельзя запускать докер по ссш из коробки, и т.п.
Для этого есть очень удобная либа [Fabricio](https://github.com/renskiy/fabricio).
Осноные возможности:

- создавать образы Docker
- создавать контейнеры и сервисы из изображений с предоставленными тегами
- неограниченная инфраструктура
- Совместимость с режимом параллельного выполнения Fabric
- откат контейнеров или сервисов до предыдущей версии
- поддержка открытых и частных реестров Docker
- развертывание по SSH-туннелю (например, доступ к реестру образов, прокси и т. д.)
- применяются миграции и откат
- резервное копирование и восстановление данных
- Сервисы Docker (режим Swarm)
- Стеки Docker (Docker Compose 3.0+)
- Kubernetes конфигурации

## Установка
`pip install fabricio`

Давайте запустим docker swarm через fabricio.
Как видим в docker-compose есть переменная окружения `$PWD` чеерз судо юзера она работатьне будет. Првоедем ее в фабрикио

- Если свои виртуалки то настройти там доступ по ssh и сделайте подобный конфиг
  
  ```python
  hosts = [
      'user@vir_machine_ip1',
      'user@vir_machine_ip2',
      'user@vir_machine_ip3',
  ]
  ```

Узнаем доступные команды через fabfile.py `fab -f docker/fabfile.py --list` ![docker_swarm_teminal6.png](./img/docker_swarm_terminal6.png)

Запустим docker swarm  и присоеденим к нему всех хостов, команда будет пропущена при ошибках
`fab -f docker/fabfile.py swarm-init`